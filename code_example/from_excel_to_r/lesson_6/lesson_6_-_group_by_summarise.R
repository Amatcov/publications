# ?????????????????????? ??????????????
library(vroom)
library(dplyr)

# ???????????????? ????????????
ga_data <- vroom("https://raw.githubusercontent.com/selesnow/publications/master/code_example/from_excel_to_r/lesson_3/ga_nowember.csv")

# ?????????????????????????? ???????????? ???? ????????
ga_data %>%
  group_by(date) %>%
  summarise(sessions = sum(sessions),
            bounces  = sum(bounces))

# ???????????? ??????????????
ga_data %>%
  group_by(date) %>%
  summarise_at(c("sessions", "bounces"), 
               sum)

# ?????????????????????? ???? ???????? ??????????
ga_data %>%
  group_by(date, medium) %>%
  summarise_at(c("sessions", "bounces"), 
               sum)

ga_data %>%
  group_by(date, medium) %>%
  summarise(ses = sum(sessions),
            bounc = sum(bounces))

# ?????????? ???? ???????? ???????????????? ????????????????
ga_data %>%
  group_by(medium) %>%
  summarise_if(is.numeric, mean)

# ???????????????????????????? ???????????????????? ?????????????? ???? ??????????????
ndays <- unique( ga_data$date ) %>% length

ga_data %>%
  group_by(medium) %>%
  summarise(daily_sessions = sum(sessions) / ndays)
